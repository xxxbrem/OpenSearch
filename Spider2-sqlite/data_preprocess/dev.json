[
    {
        "question_id": "local002",
        "db_id": "E_commerce",
        "question": "Can you calculate the 5-day symmetric moving average of predicted toy sales for December 5 to 8, 2018, using daily sales data from January 1, 2017, to August 29, 2018, with a simple linear regression model? Finally provide the sum of those four 5-day moving averages?"
    },
    {
        "question_id": "local003",
        "db_id": "E_commerce",
        "question": "According to the RFM definition document, calculate the average sales per order for each customer within distinct RFM segments, considering only 'delivered' orders. Use the customer unique identifier. Clearly define how to calculate Recency based on the latest purchase timestamp and specify the criteria for classifying RFM segments. The average sales should be computed as the total spend divided by the total number of orders. Please analyze and report the differences in average sales across the RFM segments"
    },
    {
        "question_id": "local004",
        "db_id": "E_commerce",
        "question": "Could you tell me the number of orders, average payment per order and customer lifespan in weeks of the 3 custumers with the highest average payment per order, where the lifespan is calculated by subtracting the earliest purchase date from the latest purchase date in days, dividing by seven, and if the result is less than seven days, setting it to 1.0?"
    },
    {
        "question_id": "local007",
        "db_id": "Baseball",
        "question": "Could you help me calculate the average single career span value in years for all baseball players? Please precise the result as a float number. First, calculate the difference in years, months, and days between the debut and final game dates. For each player, the career span is computed as the sum of the absolute number of years, plus the absolute number of months divided by 12, plus the absolute number of days divided by 365. Round each part to two decimal places before summing. Finally, average the career spans and round the result to a float number."
    },
    {
        "question_id": "local008",
        "db_id": "Baseball",
        "question": "I would like to know the given names of baseball players who have achieved the highest value of games played, runs, hits, and home runs, with their corresponding score values."
    },
    {
        "question_id": "local009",
        "db_id": "Airlines",
        "question": "What is the distance of the longest route where Abakan is either the departure or destination city (in kilometers)?"
    },
    {
        "question_id": "local010",
        "db_id": "Airlines",
        "question": "Distribute all the unique city pairs into the distance ranges 0, 1000, 2000, 3000, 4000, 5000, and 6000+, based on their average distance of all routes between them. Then how many pairs are there in the distance range with the fewest unique city paires?"
    },
    {
        "question_id": "local015",
        "db_id": "California_Traffic_Collision",
        "question": "Please calculate, separately for motorcycle collisions involving riders who were wearing helmets and those who were not wearing helmets, the percentage of motorcyclist fatalities per collision. For each group, compute this by dividing the total number of motorcyclist fatalities by the total number of collisions involving that group."
    },
    {
        "question_id": "local017",
        "db_id": "California_Traffic_Collision",
        "question": "In which year were the two most common causes of traffic accidents different from those in other years?"
    },
    {
        "question_id": "local018",
        "db_id": "California_Traffic_Collision",
        "question": "For the primary collision factor violation category that was the most common cause of traffic accidents in 2021, how many percentage points did its share of annual road incidents in 2021 decrease compared to its share in 2011?"
    },
    {
        "question_id": "local019",
        "db_id": "WWE",
        "question": "For the NXT title that had the shortest match (excluding titles with \"title change\"), what were the names of the two wrestlers involved?"
    },
    {
        "question_id": "local026",
        "db_id": "IPL",
        "question": "Please help me identify the top 3 bowlers who, in the overs where the maximum runs were conceded in each match, gave up the highest number of runs in a single over across all matches. For each of these bowlers, provide the match in which they conceded these maximum runs. Only consider overs that had the most runs conceded within their respective matches, and among these, determine which bowlers conceded the most runs in a single over overall."
    },
    {
        "question_id": "local020",
        "db_id": "IPL",
        "question": "Which bowler has the lowest bowling average per wicket taken?"
    },
    {
        "question_id": "local021",
        "db_id": "IPL",
        "question": "Could you calculate the average of the total runs scored by all strikers who have scored more than 50 runs in any single match?"
    },
    {
        "question_id": "local022",
        "db_id": "IPL",
        "question": "Retrieve the names of players who scored no less than 100 runs in a match while playing for the team that lost that match."
    },
    {
        "question_id": "local023",
        "db_id": "IPL",
        "question": "Please help me find the names of top 5 players with the highest average runs per match in season 5, along with their batting averages."
    },
    {
        "question_id": "local024",
        "db_id": "IPL",
        "question": "Can you help me find the top 5 countries whose players have the highest average of their individual average runs per match across all seasons? Specifically, for each player, calculate their average runs per match over all matches they played, then compute the average of these player averages for each country, and include these country batting averages in the result."
    },
    {
        "question_id": "local025",
        "db_id": "IPL",
        "question": "For each match, considering every innings, please combine runs from both batsman scored and extra runs for each over, then identify the single over with the highest total runs, retrieve the bowler for that over from the ball by ball table, and calculate the average of these highest over totals across all matches, ensuring that all runs and bowler details are accurately reflected."
    },
    {
        "question_id": "local028",
        "db_id": "Brazilian_E_Commerce",
        "question": "Could you generate a report that shows the number of delivered orders for each month in the years 2016, 2017, and 2018? Each column represents a year, and each row represents a month"
    },
    {
        "question_id": "local031",
        "db_id": "Brazilian_E_Commerce",
        "question": "What is the highest monthly delivered orders volume in the year with the lowest annual delivered orders volume among 2016, 2017, and 2018?"
    },
    {
        "question_id": "local029",
        "db_id": "Brazilian_E_Commerce",
        "question": "Please identify the top three customers, based on their customer_unique_id, who have the highest number of delivered orders, and provide the average payment value, city, and state for each of these customers."
    },
    {
        "question_id": "local030",
        "db_id": "Brazilian_E_Commerce",
        "question": "Among all cities with delivered orders, find the five cities whose summed payments are the lowest, then calculate the average of their total payments and the average of their total delivered order counts."
    },
    {
        "question_id": "local032",
        "db_id": "Brazilian_E_Commerce",
        "question": "Could you help me find the sellers respectively with the highest number of distinct customers, highest profit, highest number of distinct orders, and most 5-star ratings, in delivered orders, along with their corresponding values? "
    },
    {
        "question_id": "local034",
        "db_id": "Brazilian_E_Commerce",
        "question": "Could you help me calculate the average of the total number of payments made using the most preferred payment method for each product category, where the most preferred payment method in a category is the one with the highest number of payments?"
    },
    {
        "question_id": "local037",
        "db_id": "Brazilian_E_Commerce",
        "question": "Identify the top three product categories whose most commonly used payment type has the highest number of payments across all categories, and specify the number of payments made in each category using that payment type."
    },
    {
        "question_id": "local035",
        "db_id": "Brazilian_E_Commerce",
        "question": "In the \u201colist_geolocation\u201d table, please identify which two consecutive cities, when sorted by geolocation_state, geolocation_city, geolocation_zip_code_prefix, geolocation_lat, and geolocation_lng, have the greatest distance between them based on the difference in distance computed between each city and its immediate predecessor in that ordering."
    },
    {
        "question_id": "local038",
        "db_id": "Pagila",
        "question": "Could you help me determine which actor starred most frequently in English-language children's category films that were rated either G or PG, had a running time of 120 minutes or less, and were released between 2000 and 2010? Please provide the actor's full name."
    },
    {
        "question_id": "local039",
        "db_id": "Pagila",
        "question": "Please help me find the film category with the highest total rental hours in cities where the city's name either starts with \"A\" or contains a hyphen. "
    },
    {
        "question_id": "local040",
        "db_id": "modern_data",
        "question": "In the combined dataset that unifies the trees data with the income data by ZIP code, filling missing ZIP values where necessary, which three boroughs, restricted to records with median and mean income both greater than zero and a valid borough name, contain the highest number of trees, and what is the average mean income for each of these three boroughs?"
    },
    {
        "question_id": "local041",
        "db_id": "modern_data",
        "question": "What percentage of trees in the Bronx have a health status of Good?"
    },
    {
        "question_id": "local049",
        "db_id": "modern_data",
        "question": "Can you help me calculate the average number of new unicorn companies per year in the top industry from 2019 to 2021?"
    },
    {
        "question_id": "local054",
        "db_id": "chinook",
        "question": "Could you tell me the first names of customers who spent less than $1 on albums by the best-selling artist, along with the amounts they spent?"
    },
    {
        "question_id": "local055",
        "db_id": "chinook",
        "question": "Identify the artist with the highest overall sales of albums (tie broken by alphabetical order) and the artist with the lowest overall sales of albums (tie broken by alphabetical order), then calculate the amount each customer spent specifically on those two artists\u2019 albums. Next, compute the average spending for the customers who purchased from the top-selling artist and the average spending for the customers who purchased from the lowest-selling artist, and finally return the absolute difference between these two averages."
    },
    {
        "question_id": "local198",
        "db_id": "chinook",
        "question": "Using the sales data, what is the median value of total sales made in countries where the number of customers is greater than 4?"
    },
    {
        "question_id": "local056",
        "db_id": "sqlite-sakila",
        "question": "Which customer has the highest average monthly change in payment amounts? Provide the customer's full name."
    },
    {
        "question_id": "local058",
        "db_id": "education_business",
        "question": "Can you provide a list of hardware product segments along with their unique product counts for 2020 in the output, ordered by the highest percentage increase in unique fact sales products from 2020 to 2021?"
    },
    {
        "question_id": "local059",
        "db_id": "education_business",
        "question": "For the calendar year 2021, what is the overall average quantity sold of the top three best-selling hardware products (by total quantity sold) in each division?"
    },
    {
        "question_id": "local060",
        "db_id": "complex_oracle",
        "question": "In the United States, for Q4 2019 and Q4 2020, first select only those cities where total sales (with no promotions) rose by at least 20% from Q4 2019 to Q4 2020. Among these cities, rank products by their overall sales (still excluding promotions) in those quarters and take the top 20%. Then compute each top product\u2019s share of total sales in Q4 2019 and Q4 2020 and calculate the difference in share from Q4 2019 to Q4 2020, returning the results in descending order of that share change."
    },
    {
        "question_id": "local063",
        "db_id": "complex_oracle",
        "question": "Among all products sold in the United States with promo_id=999, considering only those cities whose sales increased by at least 20% from Q4 2019 (calendar_quarter_id=1772) to Q4 2020 (calendar_quarter_id=1776), which product that ranks in the top 20% of total sales has the smallest percentage-point change in its share of total sales between these two quarters?"
    },
    {
        "question_id": "local061",
        "db_id": "complex_oracle",
        "question": "What is the average projected monthly sales in USD for France in 2021, considering only product sales with promotions where promo_total_id = 1 and channels where channel_total_id = 1, by taking each product\u2019s monthly sales from 2019 and 2020, calculating the growth rate from 2019 to 2020 for that same product and month, applying this growth rate to project 2021 monthly sales, converting all projected 2021 amounts to USD with the 2021 exchange rates, and finally averaging and listing them by month?"
    },
    {
        "question_id": "local050",
        "db_id": "complex_oracle",
        "question": "What is the median of the average monthly projected sales in USD for France in 2021, calculated by using the monthly sales data from 2019 and 2020 (filtered by promo_total_id=1 and channel_total_id=1), applying the growth rate from 2019 to 2020 to project 2021, converting to USD based on the currency table, and then determining the monthly averages before finding their median?"
    },
    {
        "question_id": "local062",
        "db_id": "complex_oracle",
        "question": "Please group all Italian customers into ten buckets for December 2021 by summing their profits from all products purchased (where profit is calculated as quantity_sold multiplied by the difference between unit_price and unit_cost), then divide the overall range of total monthly profits into ten equal intervals. For each bucket, provide the number of customers, and identify the minimum and maximum total profits within that bucket."
    },
    {
        "question_id": "local067",
        "db_id": "complex_oracle",
        "question": "Can you provide the highest and lowest profits for Italian customers segmented into ten evenly divided tiers based on their December 2021 sales profits?"
    },
    {
        "question_id": "local070",
        "db_id": "city_legislation",
        "question": "Please examine our records for Chinese cities in July 2021 and identify both the shortest and longest streaks of consecutive date entries. List the dates along with their corresponding city names, capitalizing the first letter of each city name, for these streaks."
    },
    {
        "question_id": "local071",
        "db_id": "city_legislation",
        "question": "Could you review our records in June 2022 and identify which countries have the longest streak of consecutive inserted city dates? Please list the 2-letter length country codes of these countries."
    },
    {
        "question_id": "local072",
        "db_id": "city_legislation",
        "question": "Identify the country with data inserted on nine different days in January 2022. Then, find the longest consecutive period with data insertions for this country during January 2022, and calculate the proportion of entries that are from its capital city within this longest consecutive insertion period."
    },
    {
        "question_id": "local068",
        "db_id": "city_legislation",
        "question": "Calculate the number of new cities inserted in April, May, and June for each year from 2021 to 2023. For each month, compute the cumulative running total of cities added for that specific month across the years up to and including the given year (i.e., sum the counts of that month over the years). Additionally, calculate the year-over-year growth percentages for both the monthly total and the running total for each month, comparing each year to the previous year. Present the results only for 2022 and 2023, listing the year, the month, the total number of cities added in that month, the cumulative running total for that month, and the year-over-year growth percentages for both the monthly total and the running total. Use the data from 2021 solely as a baseline for calculating growth rates, and exclude it from the final output."
    },
    {
        "question_id": "local073",
        "db_id": "modern_data",
        "question": "For each pizza order, please list a single result row containing the row ID, order ID, customer ID, pizza name, and the final set of ingredients. The final set of ingredients should be determined by taking the standard toppings from the pizza\u2019s recipe, removing any toppings specified as exclusions, then adding any toppings specified as extras. The resulting ingredients must be presented in alphabetical order, prefixed by \u20182x\u2019 if the same ingredient appears multiple times (for example, if both standard and extra or added multiple times), and concatenated into a string that begins with the pizza name followed by \u2018: \u2019. Group by row ID, order ID, pizza name, and order time so that each order appears once, and return the listing of toppings in ascending order by row ID, ensuring that \u2018Meatlovers\u2019 pizzas receive a pizza_id of 1 while all others receive a pizza_id of 2."
    },
    {
        "question_id": "local066",
        "db_id": "modern_data",
        "question": "Based on our customer pizza order information, summarize the total quantity of each ingredient used in the pizzas we delivered. Output the name and quantity for each ingredient."
    },
    {
        "question_id": "local065",
        "db_id": "modern_data",
        "question": "Calculate the total income from Meat Lovers pizzas priced at $12 and Vegetarian pizzas at $10. Include any extra toppings charged at $1 each. Ensure that canceled orders are filtered out. How much money has Pizza Runner earned in total?"
    },
    {
        "question_id": "local074",
        "db_id": "bank_sales_trading",
        "question": "Please generate a summary of the closing balances at the end of each month for each customer transactions, show the monthly changes and monthly cumulative bank account balances. Ensure that even if a customer has no account activity in a given month, the balance for that month is still included in the output."
    },
    {
        "question_id": "local064",
        "db_id": "bank_sales_trading",
        "question": "For each customer and each month of 2020, first calculate the month-end balance by adding all deposit amounts and subtracting all withdrawal amounts that occurred during that specific month. Then determine which month in 2020 has the highest count of customers with a positive month-end balance and which month has the lowest count. For each of these two months, compute the average month-end balance across all customers and provide the difference between these two averages"
    },
    {
        "question_id": "local297",
        "db_id": "bank_sales_trading",
        "question": "For each customer, group all deposits and withdrawals by the first day of each month to obtain a monthly net amount, then calculate each month\u2019s closing balance by cumulatively summing these monthly nets. Next, determine the most recent month\u2019s growth rate by comparing its closing balance to the prior month\u2019s balance, treating deposits as positive and withdrawals as negative, and if the previous month\u2019s balance is zero, the growth rate should be the current month\u2019s balance multiplied by 100. Finally, compute the percentage of customers whose most recent month shows a growth rate of more than 5%."
    },
    {
        "question_id": "local298",
        "db_id": "bank_sales_trading",
        "question": "For each month, calculate the total balance from all users for the previous month (measured as of the 1st of each month), replacing any negative balances with zero. Ensure that data from the first month is used only as a baseline for calculating previous total balance, and exclude it from the final output. Sort the results in ascending order by month. "
    },
    {
        "question_id": "local299",
        "db_id": "bank_sales_trading",
        "question": "Could you calculate each user\u2019s average balance over the past 30 days, computed daily? Then, for each month (based on the 1st of each month), find the highest of these daily averages for each user. Add up these maximum values across all users for each month as the final result. Please use the first month as a baseline for previous balances and exclude it from the output."
    },
    {
        "question_id": "local300",
        "db_id": "bank_sales_trading",
        "question": "For each customer, calculate their daily balances for every day between their earliest and latest transaction dates, including days without transactions by carrying forward the previous day's balance. Treat any negative daily balances as zero. Then, for each month, determine the highest daily balance each customer had during that month. Finally, for each month, sum these maximum daily balances across all customers to obtain a monthly total."
    },
    {
        "question_id": "local075",
        "db_id": "bank_sales_trading",
        "question": "Can you provide a breakdown of how many times each product was viewed, how many times they were added to the shopping cart, and how many times they were left in the cart without being purchased? Also, give me the count of actual purchases for each product. Ensure that products with a page id in (1, 2, 12, 13) are filtered out."
    },
    {
        "question_id": "local077",
        "db_id": "bank_sales_trading",
        "question": "Please analyze our interest data from September 2018 to August 2019. For each month, calculate the average composition for each interest by dividing the composition by the index value. Identify the interest with the highest average composition value each month and report its average composition as the max index composition for that month. Compute the three-month rolling average of these monthly max index compositions. Ensure the output includes the date, the interest name, the max index composition for that month, the rolling average, and the names and max index compositions of the top interests from one month ago and two months ago."
    },
    {
        "question_id": "local078",
        "db_id": "bank_sales_trading",
        "question": "Identify the top 10 and bottom 10 interest categories based on their highest composition values across all months. For each category, display the time(MM-YYYY), interest name, and the composition value"
    },
    {
        "question_id": "local081",
        "db_id": "northwind",
        "question": "Considering only the customers who placed orders in 1998, calculate the total amount each customer spent by summing the unit price multiplied by the quantity of all products in their orders, excluding any discounts. Assign each customer to a spending group based on the customer group thresholds, and determine how many customers are in each spending group and what percentage of the total number of customers who placed orders in 1998 each group represents."
    },
    {
        "question_id": "local085",
        "db_id": "northwind",
        "question": "Among employees who have more than 50 total orders, which three have the highest percentage of late orders, where an order is considered late if the shipped date is on or after its required date? Please list each employee's ID, the number of late orders, and the corresponding late-order percentage."
    },
    {
        "question_id": "local096",
        "db_id": "Db-IMDB",
        "question": "For each year, calculate the proportion of films that had exclusively female actors, considering actors with gender 'Male' or 'None' (i.e., unknown or unspecified gender) as non-female. Show the proportion of female-actor-only films and the total number of all films for each year."
    },
    {
        "question_id": "local097",
        "db_id": "Db-IMDB",
        "question": "Could you analyze our data and identify which ten-year period starting from any movie release year present in the data had the largest number of films, considering consecutive ten-year periods beginning at each unique year? Only output the start year and the total count for that specific period."
    },
    {
        "question_id": "local098",
        "db_id": "Db-IMDB",
        "question": "From the first year each actor appeared in a film to the last, how many actors in the database never had a gap longer than three consecutive years without at least one new movie appearance, meaning there is no four-year span anywhere in their active career without at least a single film credit?"
    },
    {
        "question_id": "local099",
        "db_id": "Db-IMDB",
        "question": "I need you to look into the actor collaborations and tell me how many actors have made more films with Yash Chopra than with any other director. This will help us understand his influence on the industry better."
    },
    {
        "question_id": "local100",
        "db_id": "Db-IMDB",
        "question": "Find out how many actors have a 'Shahrukh number' of 2? This means they acted in a film with someone who acted with Shahrukh Khan, but not directly with him."
    },
    {
        "question_id": "local114",
        "db_id": "education_business",
        "question": "Provide a detailed web sales report for each region, including the number of orders, total sales amount, and the name and sales amount of all sales representatives who achieved the highest total sales amount in that region (include all representatives in case of a tie)."
    },
    {
        "question_id": "local128",
        "db_id": "BowlingLeague",
        "question": "List the bowlers, match number, game number, handicap score, tournament date, and location for only those bowlers who won their game with a handicap score of 190 or less at Thunderbird Lanes, Totem Lanes, and Bolero Lanes."
    },
    {
        "question_id": "local130",
        "db_id": "school_scheduling",
        "question": "Could you provide a list of last names for all students who have completed English courses, including their quintile ranks based on their individual grades in those courses (without averaging), where the quintiles are determined by ranking students according to the number of students who have grades greater than or equal to theirs, and sorted from the highest to the lowest grade quintile?"
    },
    {
        "question_id": "local131",
        "db_id": "EntertainmentAgency",
        "question": "Could you list each musical style with the number of times it appears as a 1st, 2nd, or 3rd preference in a single row per style?"
    },
    {
        "question_id": "local133",
        "db_id": "EntertainmentAgency",
        "question": "Given a database of musical styles and user preferences, where each user ranks up to three preferred styles as their first, second, and third choices, assign 3 points for each first-choice ranking, 2 points for each second-choice ranking, and 1 point for each third-choice ranking. Calculate the total weighted score for each musical style that has been ranked by at least one user. Then, compute the absolute difference between each style's total weighted score and the average total weighted score across all such styles."
    },
    {
        "question_id": "local132",
        "db_id": "EntertainmentAgency",
        "question": "Show all pairs of entertainers and customers who each have up to three style strengths or preferences, where the first and second style preferences of the customers match the first and second style strengths of the entertainers (or in reverse order). Only return the entertainer\u2019s stage name and the customer\u2019s last name"
    },
    {
        "question_id": "local141",
        "db_id": "AdventureWorks",
        "question": "How did each salesperson's annual total sales compare to their annual sales quota? Provide the difference between their total sales and the quota for each year, organized by salesperson and year."
    },
    {
        "question_id": "local152",
        "db_id": "imdb_movies",
        "question": "Can you provide the top 9 directors by movie count, including their ID, name, number of movies, average inter-movie duration (rounded to the nearest integer), average rating (rounded to 2 decimals), total votes, minimum and maximum ratings, and total movie duration? Sort the output first by movie count in descending order and then by total movie duration in descending order."
    },
    {
        "question_id": "local230",
        "db_id": "imdb_movies",
        "question": "Determine the top three genres with the most movies rated above 8, and then identify the top four directors who have directed the most films rated above 8 within those genres. List these directors and their respective movie counts."
    },
    {
        "question_id": "local156",
        "db_id": "bank_sales_trading",
        "question": "Analyze the annual average purchase price per Bitcoin by region, computed as the total dollar amount spent divided by the total quantity purchased each year, excluding the first year's data for each region. Then, for each year, rank the regions based on these average purchase prices, and calculate the annual percentage change in cost for each region compared to the previous year."
    },
    {
        "question_id": "local157",
        "db_id": "bank_sales_trading",
        "question": "Using the \"bitcoin_prices\" table, please calculate the daily percentage change in trading volume for each ticker from August 1 to August 10, 2021, ensuring that any volume ending in \"K\" or \"M\" is accurately converted to thousands or millions, any \"-\" volume is treated as zero, only non-zero volumes are used to determine the previous day's volume, and the results are ordered by ticker and date."
    },
    {
        "question_id": "local163",
        "db_id": "education_business",
        "question": "Which university faculty members' salaries are closest to the average salary for their respective ranks? Please provide the ranks, first names, last names, and salaries.university"
    },
    {
        "question_id": "local168",
        "db_id": "city_legislation",
        "question": "Among job postings that specifically have the Data Analyst, require a non-null annual average salary, and are remote, what is the overall average salary when considering only the top three most frequently demanded skills for these positions?"
    },
    {
        "question_id": "local169",
        "db_id": "city_legislation",
        "question": "What is the proportion of legislators who started their first term between 1917 and 1999 that remained in office on December 31st of each year, tracked annually for up to 20 years following their initial term start?"
    },
    {
        "question_id": "local171",
        "db_id": "city_legislation",
        "question": "For male legislators from Louisiana, how many distinct legislators were actively serving on December 31 of each year from more than 30 years since their first term up to less than 50 years, grouping the results by the exact number of years elapsed since their first term?"
    },
    {
        "question_id": "local167",
        "db_id": "city_legislation",
        "question": "Based on the state each female legislator first represented, which state has the highest number of female legislators whose terms included December 31st at any point, and what is that count? Please provide the state's abbreviation."
    },
    {
        "question_id": "local170",
        "db_id": "city_legislation",
        "question": "Identify the state abbreviations where, for both male and female legislators who began serving in that state, the retention rate of the initial cohort is greater than zero at each of the intervals 0, 2, 4, 6, 8, and 10 years after their initial term start date during the first 10 years of service."
    },
    {
        "question_id": "local193",
        "db_id": "sqlite-sakila",
        "question": "Could you find out the average percentage of the total lifetime sales (LTV) that occur in the first 7 and 30 days after a customer's initial purchase? Also, include the average total lifetime sales (LTV). Please exclude customers with zero lifetime sales. The 7- and 30-day periods should be based on the exact number of hours-minutes-seconds, not calendar days."
    },
    {
        "question_id": "local194",
        "db_id": "sqlite-sakila",
        "question": "Please provide a list of the top three revenue-generating films for each actor, along with the average revenue per actor in those films, calculated by dividing the total film revenue equally among the actors for each film."
    },
    {
        "question_id": "local195",
        "db_id": "sqlite-sakila",
        "question": "Please find out how widespread the appeal of our top five actors is. What percentage of our customers have rented films featuring these actors?"
    },
    {
        "question_id": "local196",
        "db_id": "sqlite-sakila",
        "question": "For each rating category of the first movie rented by customers\u2014where the first movie is identified based on the earliest payment date per customer\u2014please provide the average total amount spent per customer and the average number of subsequent rentals (calculated as the total number of rentals minus one) for customers whose first rented movie falls into that rating category."
    },
    {
        "question_id": "local197",
        "db_id": "sqlite-sakila",
        "question": "Among our top 10 paying customers, can you identify the largest change in payment amounts from one month to the immediately following month? Specifically, please determine for which customer and during which month this maximum month-over-month difference occurred, and provide the difference rounded to two decimal places."
    },
    {
        "question_id": "local199",
        "db_id": "sqlite-sakila",
        "question": "Can you identify the year and month with the highest rental orders created by the store's staff for each store? Please list the store ID, the year, the month, and the total rentals for those dates."
    },
    {
        "question_id": "local201",
        "db_id": "modern_data",
        "question": "Identify the first 10 words, sorted alphabetically, that are 4 to 5 characters long, start with 'r', and have at least one anagram of the same length, considering case-sensitive letters. Provide the count of such anagrams for each word."
    },
    {
        "question_id": "local202",
        "db_id": "city_legislation",
        "question": "For alien data, how many of the top 10 states by alien population have a higher percentage of friendly aliens than hostile aliens, with an average alien age exceeding 200?"
    },
    {
        "question_id": "local209",
        "db_id": "delivery_center",
        "question": "In the dataset of orders joined with store information, which store has the highest total number of orders, and among that store\u2019s orders, what is the ratio of orders that appear in the deliveries table with a 'DELIVERED' status to the total orders for that store?"
    },
    {
        "question_id": "local210",
        "db_id": "delivery_center",
        "question": "Can you identify the hubs that saw more than a 20% increase in finished orders from February to March?"
    },
    {
        "question_id": "local212",
        "db_id": "delivery_center",
        "question": "Can you find 5 delivery drivers with the highest average number of daily deliveries?"
    },
    {
        "question_id": "local218",
        "db_id": "EU_soccer",
        "question": "Can you calculate the median from the highest season goals of each team?"
    },
    {
        "question_id": "local219",
        "db_id": "EU_soccer",
        "question": "In each league, considering all seasons, which single team has the fewest total match wins based on comparing home and away goals, including teams with zero wins, ensuring that if multiple teams tie for the fewest wins, only one team is returned for each league?"
    },
    {
        "question_id": "local221",
        "db_id": "EU_soccer",
        "question": "Tell me top10 teams with the most wins across the league"
    },
    {
        "question_id": "local220",
        "db_id": "EU_soccer",
        "question": "Which player has participated in the highest number of winning matches and which player has participated in the highest number of losing matches, considering only matches where they actually played (excluding null entries) and where their team won or lost (excluding draws)?"
    },
    {
        "question_id": "local228",
        "db_id": "IPL",
        "question": "For each IPL season, identify the top three batsmen with the highest total runs scored and the top three bowlers with the most wickets taken, excluding \u2018run out\u2019, \u2018hit wicket\u2019, and \u2018retired hurt\u2019 dismissals. In the event of ties in runs or wickets, break the tie using the smaller player ID. Then output these six players in matched positions\u2014batsman 1 with bowler 1, batsman 2 with bowler 2, and batsman 3 with bowler 3\u2014in ascending order of the season ID, along with each player\u2019s total runs or wickets."
    },
    {
        "question_id": "local229",
        "db_id": "IPL",
        "question": "Find the IDs of players who scored the highest number of partnership runs for each match. The output should include the IDs of two players, each with their individual scores and the total partnership score. For each pair, the player with the higher individual score should be listed as player 1, and the player with the lower score as player 2. In cases where both players have the same score, the player with the higher ID should be player 1, and the player with the lower ID should be player 2. There can be multiple rows for a single match."
    },
    {
        "question_id": "local244",
        "db_id": "music",
        "question": "Calculate the duration of each track, classify them as short, medium, or long, output the minimum and maximum time for each kind (in minutes) and the total revenue for each category, group by the category."
    },
    {
        "question_id": "local253",
        "db_id": "education_business",
        "question": "Using a Salary Dataset where the salary values need to be cleaned by removing non-numeric characters and converting them to a numeric type, write a detailed SQL query that identifies the top 5 companies by average salary in each of Mumbai, Pune, New Delhi, and Hyderabad, then compares each company\u2019s average salary in those cities to the overall national average salary. The final result should display four columns: Location, Company Name, Average Salary in State, and Average Salary in Country, listing only the top 5 companies in each of the specified locations."
    },
    {
        "question_id": "local258",
        "db_id": "IPL",
        "question": "Calculate the total number of wickets taken by each bowler (excluding run-outs and other dismissals not attributed to the bowler), their economy rate (total runs conceded divided by total overs bowled, considering only runs scored off the bat and ignoring any extra runs like wides and no-balls), their strike rate (average number of balls bowled per wicket taken), and their best bowling performance in a single match (the match with the most wickets taken by the bowler, formatted as \"wickets-runs\" where runs are the runs conceded excluding extras)."
    },
    {
        "question_id": "local259",
        "db_id": "IPL",
        "question": "For each player, list their ID, name, their most frequent role across all matches, batting hand, bowling skill, total runs scored, total matches played, total times they were dismissed, batting average (total runs divided by total dismissals), highest score in a single match, the number of matches in which they scored at least 30 runs, at least 50 runs, and at least 100 runs, total balls faced in their career, strike rate (total runs divided by total balls faced, multiplied by 100), total wickets taken, economy rate (average runs conceded per over), and their best bowling performance in a single match (most wickets taken in a match, formatted as \"wickets taken-runs given\", where the best performance is the one with the most wickets, and if tied, the fewest runs conceded). Ignore the extra runs data."
    },
    {
        "question_id": "local262",
        "db_id": "stacking",
        "question": "Which problems exceed the total number of times they appear in the solution table when counting all occurrences, across steps 1, 2, and 3, where any non-\"Stack\" model's maximum test score is lower than the \"Stack\" model's test score for the same step and version?"
    },
    {
        "question_id": "local263",
        "db_id": "stacking",
        "question": "Identify the L1_model associated with each model (specified by name and version) that occurs most frequently for each status ('strong' or 'soft'), along with the number of times it occurs. A model has a 'strong' status if, for any of its steps, the maximum test score among non-'Stack' models is less than the 'Stack' model's test score. It has a 'soft' status if the maximum test score among non-'Stack' models equals the 'Stack' model's test score. Count how many times each L1_model is associated with a 'strong' or 'soft' status across all models, and determine which L1_model has the highest occurrence for each status."
    },
    {
        "question_id": "local264",
        "db_id": "stacking",
        "question": "Which model category (L1_model) appears the most frequently across all steps and versions when comparing traditional models to the Stack model, and what is the total count of its occurrences?"
    },
    {
        "question_id": "local269",
        "db_id": "oracle_sql",
        "question": "What is the average total quantity across all final packaging combinations, considering only the leaf-level items within each combination after fully expanding any nested packaging relationships?"
    },
    {
        "question_id": "local270",
        "db_id": "oracle_sql",
        "question": "Which top-level packaging containers, meaning those not contained within any other packaging, have any item for which the total quantity accumulated across all nested levels in the hierarchy exceeds 500, and what are the names of both these containers and the corresponding items?"
    },
    {
        "question_id": "local272",
        "db_id": "oracle_sql",
        "question": "For order 423, identify the product IDs, aisles, and positions from which to pick the exact quantities needed for each order line, ensuring that the total picked quantity for each product matches the cumulative quantities ordered without exceeding the available inventory in warehouse 1. Calculate the quantities to be picked from each location by prioritizing inventory with earlier purchased dates and smaller quantities, and ensure that picking respects the sequence and cumulative quantities of the order lines for products with multiple entries."
    },
    {
        "question_id": "local273",
        "db_id": "oracle_sql",
        "question": "Calculate the average pick percentage for each product name, using a first-in-first-out approach that selects from inventory locations based on the earliest purchase date and smallest available quantity, ensuring that the picked quantity reflects only the overlapping range between each order\u2019s required quantity and the inventory\u2019s available quantity, and then grouping and ordering the results by product name?"
    },
    {
        "question_id": "local274",
        "db_id": "oracle_sql",
        "question": "Which products were picked for order 421, and what is the average number of units picked for each product, using FIFO (First-In, First-Out) method?"
    },
    {
        "question_id": "local275",
        "db_id": "oracle_sql",
        "question": "Based on monthly sales data starting in January 2016 and using a centered moving average to adjust for seasonality, which products had a seasonality-adjusted sales ratio that stayed consistently above 2 for every month in the year 2017?"
    },
    {
        "question_id": "local277",
        "db_id": "oracle_sql",
        "question": "What is the average forecasted annual sales for products 4160 and 7790 during 2018, using monthly sales data starting from January 2016 for the first 36 months, applying seasonality adjustments from time steps 7 through 30, and employing a weighted regression method to estimate sales?"
    },
    {
        "question_id": "local279",
        "db_id": "oracle_sql",
        "question": "Using a recursive monthly inventory adjustment model starting from December 2018 inventory levels, where we restock a product if its ending inventory drops below the minimum required level, determine for each product the month in 2019 where the absolute difference between its ending inventory and the minimum required level is the smallest, and return the product_id, that month, and the absolute difference."
    },
    {
        "question_id": "local283",
        "db_id": "EU_soccer",
        "question": "Analyze the soccer match dataset to determine the champion team for each season across all countries and leagues, awarding 3 points for every win, 1 point for every tie, and 0 points for every loss. For each season, return the champion\u2019s team name, the league, the country, and the total points accumulated."
    },
    {
        "question_id": "local284",
        "db_id": "bank_sales_trading",
        "question": "For veg whsle data, can you generate a summary of our items' loss rates? Include the average loss rate, and also break down the count of items that are below, above, and within one standard deviation from this average."
    },
    {
        "question_id": "local285",
        "db_id": "bank_sales_trading",
        "question": "For veg whsle data, can you analyze our financial performance over the years 2020 to 2023? I need insights into the average wholesale price, maximum wholesale price, minimum wholesale price, wholesale price difference, total wholesale price, total selling price, average loss rate, total loss, and profit for each category within each year. Round all calculated values to two decimal places."
    },
    {
        "question_id": "local286",
        "db_id": "electronic_sales",
        "question": "Prepare a comprehensive performance report on our sellers, focusing on total sales, average item price, average review scores, and packing times. Ensure that the report includes only those sellers who have sold a quantity of more than 100 products and highlight the product category names in English with the highest sales volume."
    },
    {
        "question_id": "local301",
        "db_id": "bank_sales_trading",
        "question": "For weekly-sales data, I need an analysis of our sales performance around mid-June for the years 2018, 2019, and 2020. Specifically, calculate the percentage change in sales between the four weeks leading up to June 15 and the four weeks following June 15 for each year."
    },
    {
        "question_id": "local302",
        "db_id": "bank_sales_trading",
        "question": "Analyze the average percentage change in sales between the 12 weeks before and after June 15, 2020, for each attribute type: region, platform, age band, demographic, and customer type. For each attribute type, calculate the average percentage change in sales across all its attribute values. Identify the attribute type with the highest negative impact on sales and provide its average percentage change in sales."
    },
    {
        "question_id": "local329",
        "db_id": "log",
        "question": "How many unique sessions visited the /regist/input page and then the /regist/confirm page, in that order?"
    },
    {
        "question_id": "local330",
        "db_id": "log",
        "question": "Using only the data from the log table, compute for each web page  the number of unique user sessions where that page is either the first landing page or the exit page of the session based on the timestamp."
    },
    {
        "question_id": "local331",
        "db_id": "log",
        "question": "Which three distinct third-page visits are most frequently observed immediately after two consecutive visits to the '/detail' page, and how many times does each third-page visit occur?"
    },
    {
        "question_id": "local358",
        "db_id": "log",
        "question": "How many users are there in each age category (20s, 30s, 40s, 50s, and others)?"
    },
    {
        "question_id": "local360",
        "db_id": "log",
        "question": "Identify the sessions with the minimal number of events occurring before the first '/detail' click or '/complete' conversion within the session, considering only events with non-empty search types. If multiple sessions share this minimum count, include all of them. For each session, display the associated paths and search types."
    },
    {
        "question_id": "local344",
        "db_id": "f1",
        "question": "Considering all races where pit stop data is available, and focusing on instances when a driver was not behind another car on the previous lap but is behind on the current lap (accounting for retirements, pit-stop entries, pit-stop exits, and race starts), how many times has each type of overtake occurred in Formula 1?"
    },
    {
        "question_id": "local336",
        "db_id": "f1",
        "question": "In the first five laps of the race, how many overtakes occurred in each category\u2014retirements, pit stops, start-related overtakes, and standard on-track passes?"
    },
    {
        "question_id": "local335",
        "db_id": "f1",
        "question": "In Formula 1 seasons since 2001, considering only drivers who scored points in a season, which five constructors have had the most seasons where their drivers scored the fewest total points among all point-scoring drivers in that season?"
    },
    {
        "question_id": "local309",
        "db_id": "f1",
        "question": "For each year, which driver and which constructor scored the most points? I want the full name of each driver."
    },
    {
        "question_id": "local310",
        "db_id": "f1",
        "question": "Using only the data from the \u2018results\u2019 table, find the three years in which the sum of the highest total points earned by any driver and the highest total points earned by any constructor in that year (both calculated by summing up points from the \u2018results\u2019 table) is smallest, and list those three years in order of ascending total."
    },
    {
        "question_id": "local311",
        "db_id": "f1",
        "question": "Which constructors had the top 3 combined points from their best driver and team, and in which years did they achieve them?"
    },
    {
        "question_id": "local354",
        "db_id": "f1",
        "question": "Among Formula 1 drivers who raced during the 1950s, which drivers completed a season in that decade with the same constructor in both the first and the last race they participated in, while also taking part in at least two distinct race rounds during that season?"
    },
    {
        "question_id": "local355",
        "db_id": "f1",
        "question": "Calculate the average first and last rounds of races missed by drivers each year. Only include drivers who missed fewer than three races annually and who switched teams between the race immediately before their first missed race and the race immediately after their last missed race."
    },
    {
        "question_id": "local356",
        "db_id": "f1",
        "question": "Provide the full names of drivers who have been overtaken on track more times than they have overtaken others on track during race laps, excluding position changes due to pit stops, retirements, or movements at the start of the race."
    }
]